"use strict";var login_type="login",token=window.localStorage.getItem("token"),tokenCookie=$.cookie("Authorization");function initSwiper(){var o=new Swiper(".swiper",{spaceBetween:30,centeredSlides:!0,autoplay:!1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});return console.log("initSwiper",o),o}function triggerLoginTag(){$(".login-close").click(function(){$(".login-wrapper").toggle()}),$("#state_login .tab-item").click(function(){var o;$(this).hasClass("on")||(o=$("#state_login .tab-item").index(this),$(this).addClass("on").siblings().removeClass("on"),$("#state_login .form-box").hide().eq(o).show(),login_type=0===o?"login":"register",$("#loginBut").text(0===o?"立即登录":"立即注册"))})}function triggerPasswordIcon(){$(".password-icon").click(function(){$(this).hasClass("open")?($(this).addClass("icon-yanjing-bi").removeClass("open icon-yanjing_kai"),$(this).prev().attr("type","password")):($(this).addClass("open icon-yanjing_kai").removeClass("icon-yanjing-bi"),$(this).prev().attr("type","text"))})}function triggerVideoTab(){$(".video-tab .tab-item").click(function(){var o;$(this).hasClass("tab-active")||(o=$(".video-tab .tab-item").index(this),$(this).addClass("tab-active").siblings().removeClass("tab-active"),$(".video-box .video").hide().eq(o).show())})}function onLoginSubmit(){$("#loginBut").click(function(){("login"===login_type?loginCode:registerCode)()})}function loginCode(){var o=$(".password-login .username").val(),i=$(".password-login .password").val();console.log(o,i),o?i?(i=encryptAES(i,SLAT),console.log(i),loginApi({data:{username:o,password:i},done:function(o){console.log(o),o.code===SUCCESS_CODE&&(window.localStorage.setItem("token",o.data),$(".password-login .username").val(""),$(".password-login .password").val(""),$("#loginRegister").hide(),$("#loginSystem").show(),$(".login-wrapper").toggle(),getUserInfo()),$.toast(o.msg)},fail:function(o){$.toast(o||"登录失败，请联系管理员")}})):$.toast("请填写密码"):$.toast("请填写用户名")}function registerCode(){var o=$(".register .username").val().trim(),i=$(".register .password").val().trim();o?i?/^[a-zA-Z0-9]{6,16}$/.test(i)?registerApi({data:{username:o,password:i},done:function(o){console.log(o),o.code===SUCCESS_CODE&&($.toast("注册成功，请登录"),window.localStorage.removeItem("token"),setTimeout(function(){window.location.reload()},1e3))},fail:function(o){$.toast(o||"注册失败，请联系管理员")}}):$.toast("密码长度为6-16, 支持字母和数字的组合"):$.toast("请填写密码"):$.toast("请填写用户名")}window.eventEmitter.on("tokenOut",function(){$("#loginRegister").show()}),$(document).ready(function(){triggerLoginTag(),triggerPasswordIcon(),triggerVideoTab(),onLoginSubmit(),token?($("#loginRegister").hide(),$("#loginSystem").show()):$("#loginSystem").hide()});